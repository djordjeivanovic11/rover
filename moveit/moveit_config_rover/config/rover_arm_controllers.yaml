# =============================================================================
# ROS2 CONTROL CONFIGURATION FOR ROVER ARM
# =============================================================================
# Controller configuration for the rover arm hardware interface.
# This bridges MoveIt planning to actual hardware control.
# =============================================================================

controller_manager:
  ros__parameters:
    update_rate: 100  # 100 Hz - avoid starving service callbacks on ARM
    
    # List of controllers
    joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster
    
    arm_controller:
      type: joint_trajectory_controller/JointTrajectoryController

# Joint State Broadcaster - publishes current joint states
joint_state_broadcaster:
  ros__parameters:
    joints:
      - AB_Rev
      - AS1_Rev
      - AS2_Rev
      - AW_Rev
      - AM_Rev
    interfaces:
      - position
      - velocity

# Arm Joint Trajectory Controller - executes MoveIt trajectories
arm_controller:
  ros__parameters:
    joints:
      - AB_Rev
      - AS1_Rev
      - AS2_Rev
      - AW_Rev
      - AM_Rev
    
    command_interfaces:
      - position
    
    state_interfaces:
      - position
      - velocity
    
    state_publish_rate: 50.0
    action_monitor_rate: 20.0
    
    allow_partial_joints_goal: false
    allow_integration_in_goal_trajectories: true
    
    constraints:
      stopped_velocity_tolerance: 0.01
      goal_time: 0.5  # Allow 0.5s tolerance for goal achievement
      AB_Rev:
        trajectory: 0.1
        goal: 0.05
      AS1_Rev:
        trajectory: 0.1
        goal: 0.05
      AW_Rev:
        trajectory: 0.1
        goal: 0.05
      AM_Rev:
        trajectory: 0.1
        goal: 0.05
    
    # PID gains (harmless for mock hardware, needed for real hardware)
    gains:
      AB_Rev:
        p: 100.0
        d: 1.0
        i: 0.0
        i_clamp: 0.0
      AS1_Rev:
        p: 100.0
        d: 1.0
        i: 0.0
        i_clamp: 0.0
      AW_Rev:
        p: 100.0
        d: 1.0
        i: 0.0
        i_clamp: 0.0
      AM_Rev:
        p: 100.0
        d: 1.0
        i: 0.0
        i_clamp: 0.0

